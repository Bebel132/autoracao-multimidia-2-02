<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <link rel="stylesheet" href="style/style.css">
  <link rel="stylesheet" href="style/auth.css">
</head>

<body>
  <div class="container-auth">
    <div class="title">LOGIN</div>

    <form action="" id="login">
      <div class="input-container">
        <label for="email">E-MAIL</label>
        <input type="email" name="email" id="email">
      </div>
      <div class="input-container">
        <label for="senha">SENHA</label>
        <input type="password" name="senha" id="senha">
      </div>
      <input type="submit" value="ENTRAR">
    </form>

    <div class="firstAcess">
      <span>SUA PRIMEIRA VEZ? <a href="signin.html">CADASTRE-SE</a></span>
    </div>
  </div>
  <script type="module">
    import api from "./scripts/apiHelper.js";
    const login = document.querySelector("#login");

    login.addEventListener("submit", async e => {
      e.preventDefault();

      const email = document.querySelector("#email").value;
      const senha = document.querySelector("#senha").value;

      const res = await api.post("/login", { email, senha })

      if(res.error){
        alert(res.error);
        return;
      } else {
        // login concluido
        alert("Login realizado com sucesso!");
        localStorage.setItem("token", res.token);
        window.location = "home.html";
      }

    })
  </script>
</body>

</html>